@model List<Model.Entity_Type_Attr_Detail>

@{
    ViewBag.Title = "Import Data";
}

@section scripts {
    <script src="~/Scripts/MDM_Script/Import.js"></script>
    <script src="~/Scripts/jquery.form.js"></script>
}


@using (Html.BeginForm("ImportData", "Import", FormMethod.Post, new { enctype = "multipart/form-data", id = "formid" }))
{
    <table style="width: 100%" border="0" cellspacing="" cellpadding="0">
        <tr style="width:100%; height: 31px;">
            <td colspan="2" style="padding-left:5px">
                @if (Context.Session.GetString("SelectedDimensionData") != null && Context.Session.GetString("EntityName") != null)
                {
                    <label style="color:#f75da;font-family:Georgia;font-size:13pt;font-weight:bold">@Context.Session.GetString("SelectedDimensionData").ToString() ></label>
                    <label style="color:black;font-family:Georgia; font-weight :bold">@Context.Session.GetString("EntityName").ToString()</label>
                }
            </td>
        </tr>
        <tr style="width:100%">
            <td colspan="2">
                <hr />
            </td>
        </tr>
        <tr style="width:100%; height:25px;">
            <td colspan="2" style="width: 100%;padding-left:10px;padding-top:8px;" align="left">
                <label style="color:#ef75da;font-size:12pt;font-weight:bold">Import</label>
            </td>
        </tr>
        <tr style="width:100%;">
            <td colspan="2" style="padding-left:10px;padding-right:10px;padding-bottom:20px" valign="top">
                <hr style="width:16%;height: 2px;background-color:#084083;" />
            </td>
        </tr>
        <tr style="width: 56%;padding-left:276px;">
            <td>
                <label id="lblselectAll" class="editlabel">Select All :</label>
            </td>
            <td style="width: 50%" align="left">
                @Html.CheckBox("chkSelectAll", new { @class = "chkSelectAll" })
            </td>
        </tr>
        @foreach (var menuOption in Model)
        {
            if (@menuOption.Isvisible == "N")
            {
                <tr style="width: 100%;padding-top:8px;">
                    <td>
                        <label id=@menuOption.AttrName class="editlabel">
                            @menuOption.AttrDisplayName :
                        </label>
                    </td>
                    <td style="width: 56%" align="left">
                        @if (@menuOption.AttrDataType == "SUPPLIED_CODE")
                        {
                            @Html.CheckBox(@menuOption.AttrName, new { @class = "checkbox", @checked = true, @disabled = true })
                        }
                        else
                        {
                            @Html.CheckBox(@menuOption.AttrName, new { @class = "label" })
                        }
                        <label style="color:red">*</label>
                        @if (@menuOption.AttrDisplayName.ToUpper() == "SORT ORDER")
                        {
                            <label id="lblSORT_ORDER_format" class="hintlabel">&nbsp;(9999999999)</label>

                        }
                    </td>
                </tr>
            }
        }
        <tr style="width: 100%;padding-top:8px;">
            <td style="width: 50%;padding-left:270px;">
                <label id="lblEffectiveDate" class="editlabel">
                    Effective Date :
                </label>
            </td>
            <td style="width: 56%" align="left">
                @Html.CheckBox("DATE_FROM", new { @class = "label" })
                <label class="hintlabel">(MM/DD/YYYY)</label>
            </td>
        </tr>
        <tr style="width: 106%;padding-top:8px;">
            <td style="width: 5%;padding-left:276px;">
                <label class="editlabel">
                    File Type
                </label>
            </td>
            <td style="width: 56%;padding-left:5px;" align="left">
                @Html.DropDownList("ddlFileFormat", new List<SelectListItem>
            {
            new SelectListItem{ Text="Excel", Value="Excel" },
            new SelectListItem{ Text="Csv", Value="Csv" }
            }, new { @class = "editdropdown", @id = "ddlFileFormat" })
            </td>
        </tr>
    </table>
    <table style="width:100%;padding-top:10px;" border="0">
        <tr style="width: 100%;padding-top:8px;">
            <td style="width: 56%;padding-left:276px;"></td>
            <td style="width: 56%;padding-left:3px" align="left">
                <input type="file" name="file" id="file" />
            </td>
        </tr>
        <tr style="width: 100%" align="center">
            <td align="right"></td>
            <td align="left">
                <button type="submit" class="button" id="btnImport" style="width:88px" name="Command" value="Import">
                    <img src="~/Images/Import_Button.gif" />
                </button>&nbsp;&nbsp;&nbsp;

                <button type="submit" class="button" id="btnCancel" style="width:80px" name="Command" value="Cancel">
                    <img src="~/Images/Cancel_Button.gif" />
                </button>
            </td>
        </tr>
        <tr style="padding-top:15px;">
            <td style="width: 8%" align="right" valign="top">
                <label style="font-weight:bold">Note :</label>
            </td>
            <td align="left" style="width:92%;padding-top:18px">
                <label style="font-family:Verdana;font-size:small;font-style:italic">
                    Header Format should be
                    @foreach (var menuOption in Model)
                    {
                        <label>@menuOption.AttrName.ToString()</label>
                        <label>,</label>
                    }
                    DATE_FROM
                </label>
            </td>
        </tr>
        <tr align="center" style="width:100%">
            <td colspan="2" style="width:100%" align="center">
                <div style="display:none" id="loadingImage">
                    <img src="~/Images/Loading.gif" Height="54px" Width="86px" alt="Loading, please wait" />
                </div>
            </td>
        </tr>
    </table>

    <script type="text/javascript">
        $("#btnImport").click(function () {
            if (!confirm("Are you sure you want to Import?")) {
                return false;
            }
        });

        $('#formid').ajaxForm(function (result) {
            if (result.indexOf("error") == 0) {
                alert(result.replace("error", ""));
            } else if (result.indexOf("success") == 0) {
                alert(result.replace("success", ""));
                $.post("", function (data) {
                    if (data.indexOf("Access denied") > -1) {
                        alert(data);
                    } else {
                        $('#AttributeDetail').empty();
                        $('#AttributeDetail').html(data);
                        $('#lblcaption').html('Context.Session.GetInt32("EntityName"));
                            $("#viewPlaceHolder").empty();
                    }
                });
            } else if (result.indexOf("import") == 0) {
                window.location.href = 'Import/Download?path=' + result;
                alert("Please refer downloaded file for rejected records");
            } else {
                $("#AttributeDetail").empty();
                $("#viewPlaceHolder").empty();
                $('#AttributeDetail').html(result);
            }
        });
    </script>
}